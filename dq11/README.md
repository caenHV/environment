# Запуск caen_tools в dev режиме
(dev режим обозначает использование FakeBoard вместо реального оборудования)

## Идея
У нас три микросервиса: `WebService`, `Monitor`, `DeviceBackend`.
На данном этапе запустим их все на одной машине, но каждый в своём отдельном контейнере.

Технически для этого нужно сконфигурировать фаил для `docker compose` (*compose.yaml*), 
в котором описаны настройки отдельных докер-контейнеров.

Описание самого контейнера находится в файле *Dockerfile*

Пользовательская конфигурация сервисов `caen_tools` лежит в *config.ini*

Директория *store/* монтируется к контейнерам, в ней можно сохранять базы данных и необходимые логи.

Также необходима директория *soft/*, содержащая необходимые драйверы для работы с CAEN.

## Как запустить

* Скопировать всё содержимое текущей директории в рабочую директорию.
* Поднять микросервисы (в detach режиме, т.е. в фоне)
```bash
docker compose up -d
```

Всё должно работать, на `8000` порте рабочей машины должен появиться фронтенд интерфейс.

* Остановить микросервисы можно командой
```bash
sudo docker compose stop
```
* Удалить образы после этого можно командой
```bash
sudo docker compose down
```

## Переход к release режиму
1. В *Dockerfile* нужно изменить в `base` блоке 
адрес *.whl* модуля `caen_tools` на соответствующий release версии
1. В *Dockerfile* установить флаг true для опции privileged сервиса `devback`

## Полезные ссылки
* [Официальный сайт docker compose](https://docs.docker.com/compose/gettingstarted/)
* [Docker для новичков. Что нужно знать о docker compose](https://habr.com/ru/articles/804331/)
